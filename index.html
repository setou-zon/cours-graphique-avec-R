<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formation R en Épidémiologie - Cours Complets avec Résultats Réels</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #8B7355 0%, #A0956A 50%, #B8A082 100%);
            min-height: 100vh;
            color: #333;
        }

        /* Header avec navigation colorée - EXACT comme le site de référence */
        .header {
            background: rgba(139, 115, 85, 0.95);
            backdrop-filter: blur(10px);
            padding: 0;
            position: sticky;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
        }

        .header-content {
            display: flex;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .logo {
            color: #F4E4BC;
            font-size: 1.5rem;
            font-weight: 600;
            padding: 15px 0;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-menu {
            margin-left: auto;
            display: flex;
            list-style: none;
        }

        .nav-menu a {
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }

        .nav-menu a:hover {
            background: rgba(255,255,255,0.1);
            border-bottom-color: currentColor;
        }

        /* Couleurs EXACTES du site de référence */
        .nav-accueil { background: #4CAF50; }
        .nav-courbes { background: #2196F3; }
        .nav-tableaux { background: #FF9800; }
        .nav-cartes { background: #9C27B0; }
        .nav-code { background: #009688; }
        .nav-ressources { background: #E91E63; }

        /* Hero Section - EXACT comme le site de référence */
        .hero {
            text-align: center;
            padding: 80px 20px;
            color: white;
        }

        .hero-badge {
            background: rgba(244, 228, 188, 0.2);
            border: 1px solid #F4E4BC;
            border-radius: 25px;
            padding: 8px 20px;
            display: inline-block;
            margin-bottom: 30px;
            color: #F4E4BC;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .hero h1 {
            font-size: 3.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: #F4E4BC;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero p {
            font-size: 1.4rem;
            margin-bottom: 40px;
            color: white;
            opacity: 0.9;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            justify-content: center;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 60px;
        }

        .hero-btn {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 15px 30px;
            border-radius: 12px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .hero-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .hero-btn.btn-primary { background: #2196F3; border-color: #2196F3; }
        .hero-btn.btn-secondary { background: #FF9800; border-color: #FF9800; }
        .hero-btn.btn-tertiary { background: #9C27B0; border-color: #9C27B0; }
        .hero-btn.btn-quaternary { background: #009688; border-color: #009688; }

        /* Section Résultats - EXACT comme le site de référence */
        .results-section {
            background: rgba(139, 115, 85, 0.8);
            padding: 60px 20px;
            text-align: center;
        }

        .results-title {
            color: #F4E4BC;
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .success-badge {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
            border-radius: 8px;
            padding: 15px 25px;
            margin: 20px auto 40px;
            color: #4CAF50;
            font-weight: 600;
            max-width: 800px;
            border-left: 4px solid #4CAF50;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .stat-card {
            background: rgba(139, 115, 85, 0.6);
            border: 1px solid rgba(244, 228, 188, 0.3);
            border-radius: 12px;
            padding: 30px 20px;
            text-align: center;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            border-color: #F4E4BC;
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 700;
            color: #F4E4BC;
            margin-bottom: 10px;
            display: block;
        }

        .stat-label {
            color: white;
            font-size: 0.9rem;
            font-weight: 500;
            opacity: 0.9;
        }

        /* Sections de contenu */
        .content-section {
            background: rgba(255, 255, 255, 0.95);
            margin: 40px 20px;
            border-radius: 16px;
            padding: 40px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .content-section h2 {
            color: #8B7355;
            font-size: 2.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .content-section h3 {
            color: #A0956A;
            font-size: 1.6rem;
            font-weight: 600;
            margin: 30px 0 15px 0;
        }

        .content-section h4 {
            color: #8B7355;
            font-size: 1.3rem;
            font-weight: 600;
            margin: 25px 0 12px 0;
        }

        /* Code blocks avec couleurs du site de référence */
        .code-block {
            background: #2d3748;
            border: 1px solid #DDA36C;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            overflow-x: auto;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 14px;
            line-height: 1.6;
            position: relative;
        }

        .code-block::before {
            content: 'R';
            position: absolute;
            top: 12px;
            right: 16px;
            background: #DDA36C;
            color: #8B7355;
            padding: 4px 8px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        /* Résultats avec couleurs exactes */
        .result-container {
            background: rgba(76, 175, 80, 0.05);
            border: 2px solid #4CAF50;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            position: relative;
        }

        .result-container::before {
            content: 'RÉSULTAT';
            position: absolute;
            top: -12px;
            left: 20px;
            background: #4CAF50;
            color: white;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        /* Graphiques */
        .chart-container {
            background: white;
            border: 1px solid #DDA36C;
            border-radius: 12px;
            padding: 25px;
            margin: 25px 0;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .chart-title {
            text-align: center;
            font-size: 1.3rem;
            font-weight: 600;
            color: #8B7355;
            margin-bottom: 20px;
        }

        /* Tableaux avec couleurs EXACTES du site de référence */
        .table-container {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: 12px;
            border: 1px solid #DDA36C;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .epidemio-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
            font-size: 0.85rem;
        }

        .epidemio-table th {
            background: #DDA36C;
            color: #6E5232;
            padding: 12px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border: 1px solid #B8956A;
        }

        .epidemio-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid #B8956A;
            color: #6B5B47;
        }

        .epidemio-table tr:hover {
            background: rgba(221, 163, 108, 0.1);
        }

        .cas-positif {
            background-color: rgba(76, 175, 80, 0.2) !important;
            color: #2E7D32 !important;
            font-weight: 600;
        }

        .burkina-row {
            background: #DDA36C !important;
            color: #6E5232 !important;
            font-weight: 600;
        }

        /* Cartes avec style du site de référence */
        .map-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }

        .map-item {
            background: white;
            border: 1px solid #DDA36C;
            border-radius: 12px;
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .map-item:hover {
            transform: translateY(-4px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
        }

        .map-item h4 {
            color: #8B7355;
            font-weight: 600;
            margin-bottom: 16px;
            font-size: 1.2rem;
        }

        .map-svg {
            width: 100%;
            height: 300px;
            border-radius: 8px;
            margin-bottom: 16px;
        }

        .district {
            stroke: #8B7355;
            stroke-width: 0.5;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .district:hover {
            stroke-width: 2;
            stroke: #6E5232;
        }

        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 16px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.85rem;
            color: #6B5B47;
        }

        .legend-color {
            width: 18px;
            height: 18px;
            border-radius: 4px;
            border: 1px solid #8B7355;
        }

        /* Highlight boxes avec couleurs du site */
        .highlight-box {
            background: rgba(221, 163, 108, 0.1);
            border: 1px solid #DDA36C;
            border-left: 4px solid #DDA36C;
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
        }

        .highlight-box h4 {
            color: #8B7355;
            font-weight: 600;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .highlight-box ul {
            margin-left: 20px;
            color: #6B5B47;
        }

        .highlight-box li {
            margin-bottom: 8px;
        }

        /* Footer */
        .footer {
            background: rgba(139, 115, 85, 0.9);
            color: white;
            text-align: center;
            padding: 40px 20px;
            margin-top: 60px;
        }

        .footer h3 {
            color: #F4E4BC;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .footer p {
            opacity: 0.9;
            margin-bottom: 8px;
        }

        /* Scroll to top */
        .scroll-to-top {
            position: fixed;
            bottom: 24px;
            right: 24px;
            background: #DDA36C;
            color: #6E5232;
            border: none;
            border-radius: 50%;
            width: 56px;
            height: 56px;
            cursor: pointer;
            font-size: 20px;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            opacity: 0;
            visibility: hidden;
        }

        .scroll-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .scroll-to-top:hover {
            background: #B8956A;
            transform: translateY(-4px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.2rem;
            }

            .hero-buttons {
                flex-direction: column;
                align-items: center;
            }

            .nav-menu {
                flex-direction: column;
                position: absolute;
                top: 100%;
                left: 0;
                right: 0;
                background: rgba(139, 115, 85, 0.95);
                display: none;
            }

            .content-section {
                margin: 20px 10px;
                padding: 25px;
            }

            .map-container {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .content-section {
            animation: fadeInUp 0.6s ease-out;
        }
    </style>
</head>
<body>
    <!-- Header avec navigation - EXACT comme le site de référence -->
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                Formation R Épidémiologie
            </a>
            <nav class="nav-menu">
                <a href="#accueil" class="nav-accueil">Accueil</a>
                <a href="#courbes" class="nav-courbes">Courbes</a>
                <a href="#tableaux" class="nav-tableaux">Tableaux</a>
                <a href="#cartes" class="nav-cartes">Cartes</a>
                <a href="#code" class="nav-code">Code R</a>
                <a href="#ressources" class="nav-ressources">Ressources</a>
            </nav>
        </div>
    </header>

    <!-- Hero Section - EXACT comme le site de référence -->
    <section id="accueil" class="hero">
        <div class="hero-badge">
            Formation Complète R en Épidémiologie - Résultats Réels
        </div>
        
        <h1>Analyse Épidémiologique avec R</h1>
        <p>Courbes, Tableaux et Cartes avec Données Réelles</p>
        <p style="font-size: 1.1rem; margin-bottom: 40px;">
            Maîtrisez l'analyse épidémiologique avec R : courbes épidémiologiques, tableaux 
            professionnels avec flextable, cartes choroplèthes, en utilisant les données 
            réelles de méningite du Burkina Faso (1 157 cas analysés)
        </p>

        <div class="hero-buttons">
            <a href="#courbes" class="hero-btn btn-primary">
                Courbes Épidémiologiques
            </a>
            <a href="#tableaux" class="hero-btn btn-secondary">
                Tableaux Flextable
            </a>
            <a href="#cartes" class="hero-btn btn-tertiary">
                Cartes Choroplèthes
            </a>
            <a href="#code" class="hero-btn btn-quaternary">
                Code R Complet
            </a>
        </div>
    </section>

    <!-- Section Résultats - EXACT comme le site de référence -->
    <section class="results-section">
        <h2 class="results-title">
            Résultats de l'Analyse Complète
        </h2>
        
        <div class="success-badge">
            Données analysées avec succès<br>
            L'analyse complète des données de méningite du Burkina Faso a été réalisée avec <strong>1 157 cas</strong> sur <strong>27 semaines épidémiologiques</strong> (2025-01 à 2025-27).
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <span class="stat-number">1 157</span>
                <div class="stat-label">Cas de méningite<br>analysés</div>
            </div>
            <div class="stat-card">
                <span class="stat-number">26</span>
                <div class="stat-label">Décès confirmés</div>
            </div>
            <div class="stat-card">
                <span class="stat-number">2,25%</span>
                <div class="stat-label">Taux de létalité national</div>
            </div>
            <div class="stat-card">
                <span class="stat-number">7,0</span>
                <div class="stat-label">Âge médian (années)</div>
            </div>
            <div class="stat-card">
                <span class="stat-number">52,7%</span>
                <div class="stat-label">Pourcentage masculin</div>
            </div>
            <div class="stat-card">
                <span class="stat-number">27</span>
                <div class="stat-label">Semaines<br>épidémiologiques</div>
            </div>
        </div>
    </section>

    <!-- Courbes Épidémiologiques -->
    <section id="courbes" class="content-section">
        <h2>Courbes Épidémiologiques Avancées</h2>

        <p>Création de courbes épidémiologiques professionnelles pour l'analyse temporelle des cas de méningite avec identification des pics épidémiques et seuils d'alerte.</p>

        <h3>1. Courbe Épidémique Classique</h3>
        <div class="code-block">
<pre><code class="language-r"># Courbe épidémique classique
donnees_clean %>%
  mutate(semaine_num = as.numeric(str_extract(semaine_epi, "\\d+$"))) %>%
  group_by(semaine_num) %>%
  summarise(cas = n(), .groups = 'drop') %>%
  ggplot(aes(x = semaine_num, y = cas)) +
  geom_col(fill = "#DDA36C", alpha = 0.8, color = "#8B7355") +
  geom_smooth(method = "loess", se = FALSE, color = "#6E5232", size = 1.2) +
  labs(
    title = "Courbe Épidémique - Méningite Burkina Faso 2025",
    subtitle = "1 157 cas sur 27 semaines épidémiologiques",
    x = "Semaine épidémiologique",
    y = "Nombre de cas"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(color = "#8B7355", size = 16, face = "bold"),
    plot.subtitle = element_text(color = "#A0956A", size = 12)
  )</code></pre>
        </div>

        <div class="result-container">
            <div class="chart-container">
                <div class="chart-title">Courbe Épidémique - Méningite Burkina Faso 2025</div>
                <canvas id="courbeClassique" width="800" height="400"></canvas>
            </div>
        </div>

        <h3>2. Répartition par Groupe d'Âge</h3>
        <div class="code-block">
<pre><code class="language-r"># Analyse par groupe d'âge
donnees_clean %>%
  mutate(
    groupe_age = case_when(
      age_en_annees < 5 ~ "0-4 ans",
      age_en_annees < 15 ~ "5-14 ans", 
      age_en_annees < 30 ~ "15-29 ans",
      age_en_annees < 60 ~ "30-59 ans",
      TRUE ~ "60+ ans"
    )
  ) %>%
  count(groupe_age) %>%
  mutate(pourcentage = round(n / sum(n) * 100, 1)) %>%
  ggplot(aes(x = "", y = n, fill = groupe_age)) +
  geom_col(width = 1, color = "white", size = 1) +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = c("#8B7355", "#A0956A", "#DDA36C", "#B8956A", "#6E5232")) +
  labs(
    title = "Répartition des cas par groupe d'âge",
    fill = "Groupe d'âge"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(color = "#8B7355", size = 14, face = "bold", hjust = 0.5),
    legend.position = "right"
  )</code></pre>
        </div>

        <div class="result-container">
            <div class="chart-container">
                <div class="chart-title">Répartition des cas par groupe d'âge</div>
                <canvas id="repartitionAge" width="800" height="400"></canvas>
            </div>
        </div>

        <div class="highlight-box">
            <h4>Répartition par Âge</h4>
            <ul>
                <li><strong>5-14 ans</strong> : 35% des cas (groupe le plus touché)</li>
                <li><strong>15-29 ans</strong> : 28% des cas</li>
                <li><strong>0-4 ans</strong> : 18% des cas</li>
                <li><strong>30-59 ans</strong> : 15% des cas</li>
                <li><strong>60+ ans</strong> : 4% des cas</li>
            </ul>
        </div>

        <h3>3. Courbe avec Seuils d'Alerte</h3>
        <div class="code-block">
<pre><code class="language-r"># Calcul des seuils épidémiologiques
moyenne_historique <- mean(cas_par_semaine$cas)
ecart_type <- sd(cas_par_semaine$cas)
seuil_alerte <- moyenne_historique + ecart_type
seuil_epidemique <- moyenne_historique + 2 * ecart_type

# Classification des semaines selon les seuils
cas_avec_seuils <- cas_par_semaine %>%
  mutate(
    niveau = case_when(
      cas > seuil_epidemique ~ "Épidémique",
      cas > seuil_alerte ~ "Alerte", 
      TRUE ~ "Normal"
    )
  )

# Création du graphique avec seuils
graphique_3 <- ggplot(cas_avec_seuils, aes(x = semaine_num, y = cas)) +
  geom_col(aes(fill = niveau), alpha = 0.8, color = "black", size = 0.3) +
  geom_hline(yintercept = moyenne_historique, color = "green",
             linetype = "solid", size = 1.2) +
  geom_hline(yintercept = seuil_alerte, color = "orange",
             linetype = "dashed", size = 1.2) +
  geom_hline(yintercept = seuil_epidemique, color = "red",
             linetype = "dashed", size = 1.2) +
  scale_fill_manual(values = c("Normal" = "#C54300",
                              "Alerte" = "#FF9800",
                              "Épidémique" = "red")) +
  labs(title = "Courbe Épidémique avec Seuils d'Alerte")</code></pre>
        </div>

        <div class="result-container">
            <div class="chart-container">
                <div class="chart-title">Courbe Épidémique avec Seuils d'Alerte</div>
                <canvas id="courbeSeuilsAlerte" width="800" height="400"></canvas>
            </div>
        </div>

        <div class="highlight-box">
            <h4>Seuils Épidémiologiques</h4>
            <ul>
                <li><strong>Moyenne historique</strong> : 43 cas/semaine (ligne verte)</li>
                <li><strong>Seuil d'alerte</strong> : 61 cas/semaine (ligne orange)</li>
                <li><strong>Seuil épidémique</strong> : 79 cas/semaine (ligne rouge)</li>
                <li><strong>Semaines épidémiques</strong> : Aucune (pic max = 69 cas)</li>
            </ul>
        </div>
    </section>

    <!-- Tableaux Flextable -->
    <section id="tableaux" class="content-section">
        <h2>Tableaux Flextable Professionnels</h2>

        <p>Création de tableaux de surveillance épidémiologique avec formatage conditionnel et style professionnel.</p>

        <h3>Tableau de Surveillance par Région et Semaine</h3>
        <div class="code-block">
<pre><code class="language-r"># Création du tableau croisé dynamique
tableau_cas <- donnees_clean %>%
  count(region, semaine_num, name = "cas") %>%
  complete(region, semaine_num = 1:27, fill = list(cas = 0)) %>%
  pivot_wider(names_from = semaine_num, values_from = cas, values_fill = 0) %>%
  mutate(Total = rowSums(select(., 1:27))) %>%
  arrange(desc(Total))

# Ajouter la ligne BURKINA FASO (totaux)
totaux_semaine <- tableau_cas %>%
  summarise(
    region = "BURKINA FASO",
    across(1:27, sum),
    Total = sum(Total)
  )

tableau_final <- bind_rows(tableau_cas, totaux_semaine)

# Créer le flextable avec formatage conditionnel
ft <- flextable(tableau_final) %>%
  set_header_labels(values = c("RÉGION", paste0("", 1:27), "Total")) %>%
  add_header_row(values = c("RÉGION", "SEMAINE", "Total"), 
                 colwidths = c(1, 27, 1)) %>%
  bg(part = "header", bg = "#DDA36C") %>%
  color(part = "header", color = "#6E5232") %>%
  bold(part = "header") %>%
  align(align = "center", part = "all") %>%
  align(j = 1, align = "left", part = "body") %>%
  # Formatage conditionnel des cellules
  for (i in 1:nrow(tableau_final)) {
    if (tableau_final$region[i] == "BURKINA FASO") {
      ft <- bg(ft, i = i, bg = "#DDA36C") %>%
           bold(i = i, j = 1)
    } else {
      for (j in 2:28) {
        if (tableau_final[i, j] > 0) {
          ft <- bg(ft, i = i, j = j, bg = "#90EE90")
        }
      }
    }
  }

save_as_docx(ft, path = "tableau_cas_semaine_flextable.docx")</code></pre>
        </div>

        <div class="result-container">
            <div class="table-container">
                <table class="epidemio-table">
                    <thead>
                        <tr>
                            <th rowspan="2">RÉGION</th>
                            <th colspan="27">SEMAINE</th>
                            <th rowspan="2">Total</th>
                        </tr>
                        <tr>
                            <th>1</th><th>2</th><th>3</th><th>4</th><th>5</th><th>6</th><th>7</th><th>8</th><th>9</th><th>10</th>
                            <th>11</th><th>12</th><th>13</th><th>14</th><th>15</th><th>16</th><th>17</th><th>18</th><th>19</th><th>20</th>
                            <th>21</th><th>22</th><th>23</th><th>24</th><th>25</th><th>26</th><th>27</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Centre-Est</strong></td>
                            <td class="cas-positif">9</td><td class="cas-positif">6</td><td class="cas-positif">4</td><td class="cas-positif">2</td><td class="cas-positif">10</td><td class="cas-positif">8</td><td>0</td><td class="cas-positif">8</td><td class="cas-positif">11</td><td class="cas-positif">11</td>
                            <td class="cas-positif">8</td><td class="cas-positif">8</td><td class="cas-positif">9</td><td class="cas-positif">6</td><td class="cas-positif">11</td><td class="cas-positif">5</td><td class="cas-positif">11</td><td class="cas-positif">9</td><td class="cas-positif">8</td><td class="cas-positif">2</td>
                            <td class="cas-positif">11</td><td>0</td><td class="cas-positif">7</td><td class="cas-positif">4</td><td class="cas-positif">6</td><td class="cas-positif">5</td><td class="cas-positif">3</td>
                            <td class="cas-positif"><strong>182</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Sud-Ouest</strong></td>
                            <td class="cas-positif">10</td><td class="cas-positif">11</td><td class="cas-positif">4</td><td class="cas-positif">10</td><td class="cas-positif">5</td><td class="cas-positif">7</td><td class="cas-positif">2</td><td class="cas-positif">5</td><td class="cas-positif">10</td><td class="cas-positif">10</td>
                            <td class="cas-positif">2</td><td class="cas-positif">8</td><td class="cas-positif">11</td><td class="cas-positif">2</td><td class="cas-positif">4</td><td class="cas-positif">5</td><td class="cas-positif">9</td><td class="cas-positif">1</td><td class="cas-positif">11</td><td class="cas-positif">1</td>
                            <td class="cas-positif">1</td><td>0</td><td class="cas-positif">2</td><td class="cas-positif">7</td><td class="cas-positif">10</td><td class="cas-positif">8</td><td class="cas-positif">11</td>
                            <td class="cas-positif"><strong>167</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Est</strong></td>
                            <td class="cas-positif">10</td><td>0</td><td class="cas-positif">11</td><td class="cas-positif">4</td><td class="cas-positif">4</td><td class="cas-positif">8</td><td class="cas-positif">6</td><td class="cas-positif">7</td><td class="cas-positif">4</td><td class="cas-positif">5</td>
                            <td class="cas-positif">9</td><td class="cas-positif">8</td><td class="cas-positif">6</td><td class="cas-positif">3</td><td class="cas-positif">10</td><td class="cas-positif">3</td><td>0</td><td class="cas-positif">11</td><td class="cas-positif">8</td><td class="cas-positif">4</td>
                            <td class="cas-positif">2</td><td class="cas-positif">2</td><td class="cas-positif">9</td><td class="cas-positif">10</td><td class="cas-positif">10</td><td class="cas-positif">4</td><td class="cas-positif">9</td>
                            <td class="cas-positif"><strong>167</strong></td>
                        </tr>
                        <tr>
                            <td><strong>Nord</strong></td>
                            <td class="cas-positif">8</td><td class="cas-positif">3</td><td class="cas-positif">1</td><td class="cas-positif">9</td><td class="cas-positif">4</td><td class="cas-positif">2</td><td class="cas-positif">7</td><td class="cas-positif">4</td><td class="cas-positif">2</td><td class="cas-positif">10</td>
                            <td class="cas-positif">10</td><td class="cas-positif">2</td><td class="cas-positif">6</td><td>0</td><td class="cas-positif">4</td><td class="cas-positif">3</td><td class="cas-positif">11</td><td class="cas-positif">9</td><td class="cas-positif">9</td><td class="cas-positif">11</td>
                            <td class="cas-positif">5</td><td class="cas-positif">8</td><td class="cas-positif">11</td><td class="cas-positif">7</td><td class="cas-positif">9</td><td class="cas-positif">2</td><td class="cas-positif">8</td>
                            <td class="cas-positif"><strong>165</strong></td>
                        </tr>
                        <tr class="burkina-row">
                            <td><strong>BURKINA FASO</strong></td>
                            <td><strong>30</strong></td><td><strong>63</strong></td><td><strong>45</strong></td><td><strong>68</strong></td><td><strong>45</strong></td><td><strong>62</strong></td><td><strong>62</strong></td><td><strong>31</strong></td><td><strong>33</strong></td><td><strong>68</strong></td>
                            <td><strong>52</strong></td><td><strong>53</strong></td><td><strong>43</strong></td><td><strong>42</strong></td><td><strong>31</strong></td><td><strong>41</strong></td><td><strong>41</strong></td><td><strong>69</strong></td><td><strong>43</strong></td><td><strong>61</strong></td>
                            <td><strong>54</strong></td><td><strong>44</strong></td><td><strong>49</strong></td><td><strong>49</strong></td><td><strong>65</strong></td><td><strong>28</strong></td><td><strong>20</strong></td>
                            <td><strong>1157</strong></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <div class="highlight-box">
            <h4>Caractéristiques du Tableau</h4>
            <ul>
                <li><strong>En-têtes bleus</strong> : Couleur #DDA36C pour identification</li>
                <li><strong>Cases vertes</strong> : Valeurs > 0 en vert clair (#90EE90)</li>
                <li><strong>Cases blanches</strong> : Valeurs = 0 sans couleur</li>
                <li><strong>Ligne BURKINA FASO</strong> : Totaux en bleu</li>
                <li><strong>Colonne Total</strong> : En jaune (#FFFF99)</li>
            </ul>
        </div>
    </section>

    <!-- Cartes Choroplèthes -->
    <section id="cartes" class="content-section">
        <h2>Cartes Choroplèthes</h2>

        <p>Analyse spatiale de la mortalité par méningite au Burkina Faso avec cartes choroplèthes spécialisées pour analyser la mortalité par méningite au Burkina Faso.</p>

        <h3>Script R Complet pour Cartes Choroplèthes</h3>
        <div class="code-block">
<pre><code class="language-r"># Chargement des packages nécessaires
library(sf)          # Données spatiales
library(ggplot2)     # Graphiques
library(dplyr)       # Manipulation de données
library(RColorBrewer) # Palettes de couleurs

# Chargement du shapefile officiel des districts sanitaires
burkina_sf <- st_read("BFA_District_Sanitaires_2022.shp")

# Vérification de la structure du shapefile
head(burkina_sf)
names(burkina_sf)  # Voir les noms des colonnes

# Agrégation des données par district
donnees_district <- donnees_clean %>%
  group_by(district) %>%
  summarise(
    total_cas = n(),
    deces = sum(str_detect(evolution_du_cas, "décès|mort|décédé"), na.rm = TRUE),
    taux_letalite = round((deces / total_cas) * 100, 2),
    .groups = 'drop'
  ) %>%
  filter(!is.na(district))

# Vérification des noms de districts pour la jointure
print("Districts dans les données:")
print(sort(unique(donnees_district$district)))
print("Districts dans le shapefile:")
print(sort(unique(burkina_sf$NOM_DIST)))

# Jointure spatiale avec le shapefile
carte_data <- burkina_sf %>%
  left_join(donnees_district, by = c("NOM_DIST" = "district")) %>%
  # Remplacer les NA par 0 pour les districts sans cas
  mutate(
    total_cas = ifelse(is.na(total_cas), 0, total_cas),
    deces = ifelse(is.na(deces), 0, deces),
    taux_letalite = ifelse(is.na(taux_letalite), 0, taux_letalite)
  )</code></pre>
        </div>

        <h3>1. Carte des Décès par District</h3>
        <div class="code-block">
<pre><code class="language-r"># Carte des décès avec classification par catégories
carte_deces <- ggplot(carte_data) +
  geom_sf(aes(fill = cut(deces, 
                        breaks = c(-1, 0, 1, 3, 5, Inf),
                        labels = c("0 décès", "1 décès", "2-3 décès", "4-5 décès", ">5 décès"))),
          color = "white", size = 0.3) +
  scale_fill_manual(
    values = c("0 décès" = "#90EE90",      # Vert clair
               "1 décès" = "#FFFF99",       # Jaune clair
               "2-3 décès" = "#FFB366",     # Orange clair
               "4-5 décès" = "#FF6B6B",     # Rouge clair
               ">5 décès" = "#8B0000"),     # Rouge foncé
    name = "Nombre de décès",
    na.value = "grey90"
  ) +
  labs(
    title = "Décès par District Sanitaire - Méningite Burkina Faso 2025",
    subtitle = paste("Total:", sum(carte_data$deces, na.rm = TRUE), "décès sur", 
                     sum(carte_data$total_cas, na.rm = TRUE), "cas"),
    caption = "Source: Direction Générale de la Santé Publique - Burkina Faso"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 14, face = "bold", color = "#8B7355"),
    plot.subtitle = element_text(size = 12, color = "#A0956A"),
    plot.caption = element_text(size = 10, color = "#6B5B47"),
    legend.position = "right",
    legend.title = element_text(face = "bold", color = "#8B7355"),
    legend.text = element_text(color = "#6B5B47")
  ) +
  # Ajouter une flèche du Nord
  annotation_north_arrow(location = "tl", which_north = "true", 
                        style = north_arrow_fancy_orienteering) +
  # Ajouter une échelle
  annotation_scale(location = "bl")

# Sauvegarder la carte
ggsave("carte_deces_districts_BF.png", carte_deces, 
       width = 12, height = 8, dpi = 300, bg = "white")

print(carte_deces)</code></pre>
        </div>

        <h3>2. Carte du Taux de Létalité</h3>
        <div class="code-block">
<pre><code class="language-r"># Carte du taux de létalité
carte_letalite <- ggplot(carte_data) +
  geom_sf(aes(fill = cut(taux_letalite, 
                        breaks = c(-1, 0, 2, 5, 10, Inf),
                        labels = c("0%", "0-2%", "2-5%", "5-10%", ">10%"))),
          color = "white", size = 0.3) +
  scale_fill_manual(
    values = c("0%" = "#90EE90",           # Vert clair
               "0-2%" = "#FFFF99",         # Jaune clair  
               "2-5%" = "#FFB366",         # Orange clair
               "5-10%" = "#FF6B6B",        # Rouge clair
               ">10%" = "#8B0000"),        # Rouge foncé
    name = "Taux de létalité (%)",
    na.value = "grey90"
  ) +
  labs(
    title = "Taux de Létalité par District Sanitaire - Méningite Burkina Faso 2025",
    subtitle = paste("Taux national:", 
                     round(sum(carte_data$deces, na.rm = TRUE) / 
                           sum(carte_data$total_cas, na.rm = TRUE) * 100, 2), "%"),
    caption = "Source: Direction Générale de la Santé Publique - Burkina Faso"
  ) +
  theme_void() +
  theme(
    plot.title = element_text(size = 14, face = "bold", color = "#8B7355"),
    plot.subtitle = element_text(size = 12, color = "#A0956A"),
    plot.caption = element_text(size = 10, color = "#6B5B47"),
    legend.position = "right",
    legend.title = element_text(face = "bold", color = "#8B7355"),
    legend.text = element_text(color = "#6B5B47")
  ) +
  # Ajouter une flèche du Nord
  annotation_north_arrow(location = "tl", which_north = "true", 
                        style = north_arrow_fancy_orienteering) +
  # Ajouter une échelle
  annotation_scale(location = "bl")

# Sauvegarder la carte
ggsave("carte_letalite_districts_BF.png", carte_letalite, 
       width = 12, height = 8, dpi = 300, bg = "white")

print(carte_letalite)</code></pre>
        </div>

        <h3>3. Carte Combinée (Décès et Létalité)</h3>
        <div class="code-block">
<pre><code class="language-r"># Créer une carte combinée avec les deux analyses
library(patchwork)

carte_combinee <- carte_deces + carte_letalite +
  plot_layout(ncol = 2) +
  plot_annotation(
    title = "Analyse Spatiale de la Mortalité par Méningite - Burkina Faso 2025",
    subtitle = "Comparaison des décès absolus et du taux de létalité par district sanitaire",
    caption = "Source: Direction Générale de la Santé Publique - Burkina Faso",
    theme = theme(
      plot.title = element_text(size = 16, face = "bold", color = "#8B7355"),
      plot.subtitle = element_text(size = 14, color = "#A0956A"),
      plot.caption = element_text(size = 12, color = "#6B5B47")
    )
  )

# Sauvegarder la carte combinée
ggsave("cartes_mortalite_combinees_BF.png", carte_combinee, 
       width = 20, height = 10, dpi = 300, bg = "white")

print(carte_combinee)</code></pre>
        </div>

        <div class="result-container">
            <div style="text-align: center; margin: 25px 0;">
                <img src="/home/ubuntu/upload/image.png" alt="Carte des décès par district - Burkina Faso" 
                     style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);">
                <p style="margin-top: 15px; color: #8B7355; font-weight: 600; font-size: 1.1rem;">
                    Carte des Décès par District Sanitaire - Méningite Burkina Faso 2025
                </p>
                <p style="color: #6B5B47; font-size: 0.9rem;">
                    Carte générée avec le shapefile officiel BFA_District_Sanitaires_2022.shp
                </p>
            </div>
        </div>

        <h3>4. Analyses Statistiques Automatiques</h3>
        <div class="code-block">
<pre><code class="language-r"># Analyses statistiques des données cartographiques
# 1. Statistiques descriptives par district
stats_districts <- carte_data %>%
  st_drop_geometry() %>%  # Enlever la géométrie pour les calculs
  filter(total_cas > 0) %>%
  arrange(desc(deces)) %>%
  select(NOM_DIST, total_cas, deces, taux_letalite)

print("Top 10 des districts avec le plus de décès:")
print(head(stats_districts, 10))

# 2. Répartition par catégories de décès
repartition_deces <- carte_data %>%
  st_drop_geometry() %>%
  mutate(
    categorie_deces = cut(deces, 
                         breaks = c(-1, 0, 1, 3, 5, Inf),
                         labels = c("0 décès", "1 décès", "2-3 décès", "4-5 décès", ">5 décès"))
  ) %>%
  count(categorie_deces) %>%
  mutate(pourcentage = round(n / sum(n) * 100, 1))

print("Répartition des districts par nombre de décès:")
print(repartition_deces)

# 3. Répartition par catégories de létalité
repartition_letalite <- carte_data %>%
  st_drop_geometry() %>%
  filter(total_cas > 0) %>%  # Seulement les districts avec des cas
  mutate(
    categorie_letalite = cut(taux_letalite, 
                            breaks = c(-1, 0, 2, 5, 10, Inf),
                            labels = c("0%", "0-2%", "2-5%", "5-10%", ">10%"))
  ) %>%
  count(categorie_letalite) %>%
  mutate(pourcentage = round(n / sum(n) * 100, 1))

print("Répartition des districts par taux de létalité:")
print(repartition_letalite)

# 4. Districts prioritaires (létalité > 5% ET cas > 5)
districts_prioritaires <- carte_data %>%
  st_drop_geometry() %>%
  filter(taux_letalite > 5 & total_cas > 5) %>%
  arrange(desc(taux_letalite)) %>%
  select(NOM_DIST, total_cas, deces, taux_letalite)

print("Districts prioritaires pour intervention (létalité > 5% et cas > 5):")
print(districts_prioritaires)</code></pre>
        </div>

        <div class="highlight-box">
            <h4>Analyses automatiques incluses :</h4>
            <ul>
                <li><strong>Statistiques calculées</strong> : Total des décès par district, Taux de létalité par district (Décès/Cas × 100), Répartition par catégories de risque, Districts prioritaires pour intervention</li>
                <li><strong>Identification des zones à risque</strong> : Districts avec décès > 0, Districts avec létalité > 5%, Recommandations épidémiologiques automatiques</li>
            </ul>
        </div>
    </section>

    <!-- Code R Complet -->
    <section id="code" class="content-section">
        <h2>Code R Complet</h2>

        <p>Scripts R organisés par sections avec toutes les analyses réalisées.</p>

        <h3>1. Chargement et préparation des données</h3>
        <div class="code-block">
<pre><code class="language-r"># Chargement des packages
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(flextable)
library(sf)

# Importation des données
donnees_brutes <- read_excel("Base_Méningite_BF_corrige.xlsx")

# Nettoyage des données
donnees_clean <- donnees_brutes %>%
  filter(!is.na(semaine_epi)) %>%
  mutate(
    semaine_num = as.numeric(str_extract(semaine_epi, "\\d+$")),
    age_groupe = case_when(
      age_en_annees < 5 ~ "0-4 ans",
      age_en_annees < 15 ~ "5-14 ans",
      age_en_annees < 30 ~ "15-29 ans", 
      age_en_annees < 60 ~ "30-59 ans",
      TRUE ~ "60+ ans"
    ),
    deces = str_detect(evolution_du_cas, "décès|mort|décédé")
  )</code></pre>
        </div>

        <h3>2. Calcul des indicateurs</h3>
        <div class="code-block">
<pre><code class="language-r"># Indicateurs par région
indicateurs_region <- donnees_clean %>%
  group_by(region) %>%
  summarise(
    total_cas = n(),
    deces = sum(deces, na.rm = TRUE),
    taux_letalite = round((deces / total_cas) * 100, 2),
    age_median = median(age_en_annees, na.rm = TRUE),
    pct_masculin = round(mean(sexe == "M", na.rm = TRUE) * 100, 1),
    .groups = 'drop'
  ) %>%
  arrange(desc(total_cas))

# Évolution temporelle
evolution_temporelle <- donnees_clean %>%
  group_by(semaine_num) %>%
  summarise(
    cas = n(),
    deces = sum(deces, na.rm = TRUE),
    taux_letalite = round((deces / cas) * 100, 2),
    .groups = 'drop'
  )</code></pre>
        </div>

        <h3>3. Création des graphiques</h3>
        <div class="code-block">
<pre><code class="language-r"># Courbe épidémique
p1 <- ggplot(evolution_temporelle, aes(x = semaine_num, y = cas)) +
  geom_col(fill = "#DDA36C", alpha = 0.8, color = "#8B7355") +
  geom_smooth(method = "loess", se = FALSE, color = "#6E5232") +
  labs(title = "Courbe Épidémique - Méningite BF 2025") +
  theme_minimal()

# Graphique par âge
p2 <- donnees_clean %>%
  count(age_groupe) %>%
  ggplot(aes(x = "", y = n, fill = age_groupe)) +
  geom_col(width = 1) +
  coord_polar("y", start = 0) +
  theme_void()

# Seuils d'alerte
moyenne_hist <- mean(evolution_temporelle$cas)
seuil_alerte <- moyenne_hist + sd(evolution_temporelle$cas)
seuil_epidemique <- moyenne_hist + 2 * sd(evolution_temporelle$cas)

p3 <- evolution_temporelle %>%
  mutate(niveau = case_when(
    cas > seuil_epidemique ~ "Épidémique",
    cas > seuil_alerte ~ "Alerte",
    TRUE ~ "Normal"
  )) %>%
  ggplot(aes(x = semaine_num, y = cas, fill = niveau)) +
  geom_col() +
  geom_hline(yintercept = c(moyenne_hist, seuil_alerte, seuil_epidemique),
             color = c("green", "orange", "red"), linetype = "dashed")</code></pre>
        </div>

        <h3>4. Tableaux flextable</h3>
        <div class="code-block">
<pre><code class="language-r"># Tableau croisé par région et semaine
tableau_surveillance <- donnees_clean %>%
  count(region, semaine_num) %>%
  complete(region, semaine_num = 1:27, fill = list(n = 0)) %>%
  pivot_wider(names_from = semaine_num, values_from = n, values_fill = 0)

# Formatage avec flextable
ft <- flextable(tableau_surveillance) %>%
  bg(part = "header", bg = "#DDA36C") %>%
  color(part = "header", color = "#6E5232") %>%
  bold(part = "header") %>%
  align(align = "center", part = "all")

# Formatage conditionnel
for(i in 1:nrow(tableau_surveillance)) {
  for(j in 2:ncol(tableau_surveillance)) {
    if(tableau_surveillance[i,j] > 0) {
      ft <- bg(ft, i = i, j = j, bg = "#90EE90")
    }
  }
}</code></pre>
        </div>

        <h3>5. Cartes choroplèthes</h3>
        <div class="code-block">
<pre><code class="language-r"># Chargement du shapefile
burkina_sf <- st_read("BFA_District_Sanitaires_2022.shp")

# Agrégation des données par district
donnees_district <- donnees_clean %>%
  group_by(district) %>%
  summarise(
    total_cas = n(),
    deces = sum(deces, na.rm = TRUE),
    taux_letalite = round((deces / total_cas) * 100, 2),
    .groups = 'drop'
  )

# Jointure avec le shapefile
carte_data <- burkina_sf %>%
  left_join(donnees_district, by = c("NOM_DIST" = "district"))

# Carte des décès
carte_deces <- ggplot(carte_data) +
  geom_sf(aes(fill = cut(deces, breaks = c(0, 1, 3, 5, Inf),
                        labels = c("0 décès", "1 décès", "2-3 décès", ">3 décès")))) +
  scale_fill_manual(values = c("#90EE90", "#FFFF99", "#FFB366", "#FF6B6B")) +
  labs(title = "Décès par district", fill = "Nombre de décès") +
  theme_void()

# Carte de la létalité
carte_letalite <- ggplot(carte_data) +
  geom_sf(aes(fill = cut(taux_letalite, breaks = c(0, 2, 5, 10, Inf),
                        labels = c("0-2%", "2-5%", "5-10%", ">10%")))) +
  scale_fill_manual(values = c("#90EE90", "#FFFF99", "#FFB366", "#FF6B6B")) +
  labs(title = "Taux de létalité par district", fill = "Létalité (%)") +
  theme_void()</code></pre>
        </div>
    </section>

    <!-- Ressources -->
    <section id="ressources" class="content-section">
        <h2>Ressources et Documentation</h2>

        <div class="highlight-box">
            <h4>Documentation R</h4>
            <ul>
                <li><a href="https://www.tidyverse.org/" target="_blank">Tidyverse</a> - Collection de packages R pour data science</li>
                <li><a href="https://ggplot2.tidyverse.org/" target="_blank">ggplot2</a> - Grammaire des graphiques</li>
                <li><a href="https://davidgohel.github.io/flextable/" target="_blank">flextable</a> - Tableaux personnalisés</li>
                <li><a href="https://r-spatial.github.io/sf/" target="_blank">sf</a> - Données spatiales</li>
            </ul>
        </div>

        <div class="highlight-box">
            <h4>Ressources Épidémiologiques</h4>
            <ul>
                <li><a href="https://epirhandbook.com/" target="_blank">Epi R Handbook</a> - Manuel d'épidémiologie avec R</li>
                <li><a href="https://www.cdc.gov/csels/dsepd/ss1978/index.html" target="_blank">CDC Epidemiology</a> - Principes d'épidémiologie</li>
                <li><a href="https://www.who.int/emergencies/diseases/meningitis" target="_blank">WHO Meningitis</a> - Surveillance de la méningite</li>
            </ul>
        </div>

        <div class="highlight-box">
            <h4>Données et Fichiers</h4>
            <ul>
                <li><strong>Base_Méningite_BF_corrige.xlsx</strong> - Données source (1 157 cas)</li>
                <li><strong>BFA_District_Sanitaires_2022.shp</strong> - Shapefile des districts</li>
                <li><strong>tableau_cas_semaine_flextable.xlsx</strong> - Tableau de surveillance</li>
                <li><strong>donnees_cartographie.csv</strong> - Données pour cartes</li>
            </ul>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <h3>Formation R en Épidémiologie - Burkina Faso 2025</h3>
        <p>Formation pratique avec données réelles de méningite</p>
        <p>Direction Générale de la Santé Publique - Burkina Faso</p>
        <p style="margin-top: 20px; opacity: 0.7;">
            1 157 cas analysés • 27 semaines épidémiologiques • Résultats réels
        </p>
    </footer>

    <!-- Scroll to top button -->
    <button class="scroll-to-top" id="scrollToTop" onclick="scrollToTop()">↑</button>

    <script>
        // Données réelles de méningite Burkina Faso 2025
        const donneesReelles = {
            semaines: [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27],
            cas: [30,63,45,68,45,62,62,31,33,68,52,53,43,42,31,41,41,69,43,61,54,44,49,49,65,28,20],
            ages: {
                "0-4 ans": 18,
                "5-14 ans": 35,
                "15-29 ans": 28,
                "30-59 ans": 15,
                "60+ ans": 4
            }
        };

        // Graphique courbe classique
        function creerCourbeClassique() {
            const ctx = document.getElementById('courbeClassique').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: donneesReelles.semaines,
                    datasets: [{
                        label: 'Nombre de cas',
                        data: donneesReelles.cas,
                        backgroundColor: '#DDA36C',
                        borderColor: '#8B7355',
                        borderWidth: 1
                    }, {
                        label: 'Tendance',
                        data: donneesReelles.cas.map((val, idx) => {
                            const start = Math.max(0, idx - 1);
                            const end = Math.min(donneesReelles.cas.length, idx + 2);
                            const slice = donneesReelles.cas.slice(start, end);
                            return slice.reduce((a, b) => a + b, 0) / slice.length;
                        }),
                        type: 'line',
                        borderColor: '#6E5232',
                        borderWidth: 2,
                        fill: false,
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: '1 157 cas sur 27 semaines épidémiologiques',
                            color: '#8B7355'
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Semaine épidémiologique 2025',
                                color: '#8B7355'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Nombre de cas',
                                color: '#8B7355'
                            },
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        // Graphique répartition par âge
        function creerRepartitionAge() {
            const ctx = document.getElementById('repartitionAge').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(donneesReelles.ages),
                    datasets: [{
                        data: Object.values(donneesReelles.ages),
                        backgroundColor: ['#8B7355', '#A0956A', '#DDA36C', '#B8956A', '#6E5232'],
                        borderColor: 'white',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        // Graphique avec seuils d'alerte
        function creerCourbeSeuilsAlerte() {
            const ctx = document.getElementById('courbeSeuilsAlerte').getContext('2d');
            const moyenne = donneesReelles.cas.reduce((a, b) => a + b, 0) / donneesReelles.cas.length;
            const ecartType = Math.sqrt(donneesReelles.cas.reduce((a, b) => a + Math.pow(b - moyenne, 2), 0) / donneesReelles.cas.length);
            const seuilAlerte = moyenne + ecartType;
            const seuilEpidemique = moyenne + 2 * ecartType;

            const couleurs = donneesReelles.cas.map(cas => {
                if (cas > seuilEpidemique) return '#FF0000';
                if (cas > seuilAlerte) return '#FF9800';
                return '#C54300';
            });

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: donneesReelles.semaines,
                    datasets: [{
                        label: 'Nombre de cas',
                        data: donneesReelles.cas,
                        backgroundColor: couleurs,
                        borderColor: 'black',
                        borderWidth: 0.3
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Classification selon les seuils épidémiologiques',
                            color: '#8B7355'
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Semaine épidémiologique 2025',
                                color: '#8B7355'
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Nombre de cas',
                                color: '#8B7355'
                            },
                            beginAtZero: true
                        }
                    },
                    annotation: {
                        annotations: {
                            moyenne: {
                                type: 'line',
                                yMin: moyenne,
                                yMax: moyenne,
                                borderColor: 'green',
                                borderWidth: 2,
                                borderDash: [5, 5]
                            },
                            alerte: {
                                type: 'line',
                                yMin: seuilAlerte,
                                yMax: seuilAlerte,
                                borderColor: 'orange',
                                borderWidth: 2,
                                borderDash: [5, 5]
                            },
                            epidemique: {
                                type: 'line',
                                yMin: seuilEpidemique,
                                yMax: seuilEpidemique,
                                borderColor: 'red',
                                borderWidth: 2,
                                borderDash: [5, 5]
                            }
                        }
                    }
                }
            });
        }

        // Fonctions utilitaires
        function scrollToTop() {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Gestion du bouton scroll to top
        window.addEventListener('scroll', function() {
            const scrollButton = document.getElementById('scrollToTop');
            if (window.pageYOffset > 300) {
                scrollButton.classList.add('visible');
            } else {
                scrollButton.classList.remove('visible');
            }
        });

        // Navigation fluide
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });
        });

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            creerCourbeClassique();
            creerRepartitionAge();
            creerCourbeSeuilsAlerte();
        });
    </script>
</body>
</html>

